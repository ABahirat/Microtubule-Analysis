# HMM for microtubule state anylsis

This is a program for the purpose of determining the state of microtubles given length data. It does this using Hidden Markov Models and the Viterbi algorithm

## How to run

This program is run using command line arguments. It can either be run with truth data or with an output data file that the program will dump the results into.

The program has the following options:

- -L specifies lengths file to be trained on
- -S specifies states file to be trained on
- -O specifies observation file to run algorithm on
- -T specifies the truth data to check the algorithm against
- -A specifies the algorithm to run (currently only viterbi)
- -B specifies the bins to use for observations
- -W specifies the file to write the output to if running without truth data

For example the program can be run with truth data with the following:

`python hmm.py -L lengths.csv -S states.cvs -O obs.csv -T truth.csv -A viterbi`

Or with no truth data but an output file:

`python hmm.py -L lengths.csv -S states.cvs -O obs.csv -W output.csv -A viterbi`

There are lots of example BASH test scripts in the test scripts directory that are examples as well. 

## Analytics

The analytics file has a menu system where you can decide which tests to run. To see examples of what each of the tests are check out the plots file. The names of the plots are autogenerated based on the files they are run on. These files are decided in the lists for the truth and observations at the top of the anayltics.py file. To add more tests all you need to do is add more oberservations and cooresponding truth files.

For testing the accuracy there needs to be an even number of files in the the top lists. The program will use the first oberservation and truth list items and train on those. Then it will run viterbi on the second item in the oberservations list and check it with the second item in the truth list. It will then do this with the 3rd and 4th and so on. These specitifcaitons don't need to be followed if the accuracy meassures are not used when running the analytics. 


